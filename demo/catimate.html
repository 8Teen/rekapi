
<!DOCTYPE html>
<html>
<head>
  <script src="../dist/underscore.js"></script>
  <script src="../dist/shifty.js"></script>
  <script src="../dist/rekapi.min.js"></script>
  <!--<script src="../src/rekapi.core.js"></script>-->
  <!--<script src="../src/rekapi.actor.js"></script>-->
  <!--<script src="../src/rekapi.canvas.js"></script>-->
  <!--<script src="../src/rekapi.interpolate.js"></script>-->
</head>
<body>
  <canvas></canvas>
  <!-- This is the laziest image preload known to man. -->
  <img src="img/meow.jpeg" style="position: absolute; left: -10000em;" />
  <script>
  (function (global) {

    var catUrl = document.getElementsByTagName('img')[0].src,
        catImg = new Image();

    catImg.src = catUrl;

    function degToRad (deg) {
      return (deg / 180) * Math.PI;
    }


    function makeCatActor () {
      return new Kapi.Actor({
        'draw': function (context, state) {
          context.rotate(degToRad(state.rotate || 0));
          context.drawImage(
            catImg, 
            state.x, 
            state.y, 
            240, 
            160);
          context.rotate(-degToRad(state.rotate || 0));
        }
      });
    }


    var canvas = document.getElementsByTagName('canvas')[0]
        ,kapi = new Kapi(canvas, {
          'fps': 60
          ,'height': 500
          ,'width': 600
        })
        ,cats = [];

    kapi.canvas_style('background', '#eee');
    cats[0] = makeCatActor();
    
    _.each(cats, function (cat) {
      kapi.addActor(cat);
    });

    cats[0]
      .keyframe(0, {
        'x': -240
        ,'y': -160
      }).keyframe(1750, {
        'x': 300
        ,'y': 250
      }, 'bouncePast')
      .liveCopy(3000)
      .keyframe(4000, {
        'x': 50
        ,'rotate': 0
      }, 'easeInOutBack')
      .liveCopy(5000)
      .keyframe(6500, {
        'x': -240
        ,'y': 440
        ,'rotate': -90
      }, 'easeFromTo')
      .keyframe(7350, {
        'x': -800
      }, 'easeFrom')
      .liveCopy(9000);

    catImg.onload = function () {
      kapi.play();
    }
  
  } (this));
  </script>
</body>
</html>
