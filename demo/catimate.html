
<!DOCTYPE html>
<html>
<head>
  <script src="../dist/underscore.js"></script>
  <script src="../dist/shifty.js"></script>
  <script src="../dist/rekapi.min.js"></script>
  <!--<script src="../src/rekapi.core.js"></script>-->
  <!--<script src="../src/rekapi.actor.js"></script>-->
  <!--<script src="../src/rekapi.canvas.js"></script>-->
  <!--<script src="../src/rekapi.interpolate.js"></script>-->
</head>
<body>
  <canvas></canvas>
  <!-- This is the laziest image preload known to man. -->
  <img src="img/octocat.png" style="position: absolute; left: -10000em;" />
  <script>
  (function (global) {

    var catUrl = document.getElementsByTagName('img')[0].src,
        catImg = new Image();

    catImg.src = catUrl;

    function degToRad (deg) {
      return (deg / 180) * Math.PI;
    }


    function makeCatActor () {
      return new Kapi.Actor({
        'draw': function (context, state) {
          context.rotate(degToRad(state.rotate || 0));
          context.drawImage(
            catImg, 
            state.x, 
            state.y, 
            256, 
            256);
          context.rotate(-degToRad(state.rotate || 0));
        }
      });
    }


    var canvas = document.getElementsByTagName('canvas')[0]
        ,kapi = new Kapi(canvas, {
          'fps': 60
          ,'height': 500
          ,'width': 600
        })
        ,cat
        ,time = 0;

    kapi.canvas_style('background', '#eee');
    cat = makeCatActor();
    kapi.addActor(cat);

    cat
      .keyframe(time, {
        'x': -240
        ,'y': -160
      }).keyframe(time += 1200, {
        'x': 300
        ,'y': 250
      }, 'bouncePast')
      .liveCopy(time += 400)
      .keyframe(time += 700, {
        'x': 50
        ,'rotate': 0
      }, 'easeInOutBack')
      .liveCopy(time += 150)
      .keyframe(time += 850, {
        'x': -256
        ,'y': 344
        ,'rotate': -90
      }, 'easeFromTo')
      .keyframe(time += 700, {
        'x': -800
      }, 'easeFrom')
      .liveCopy(time += 500);

    catImg.onload = function () {
      kapi.play();
    }
  
  } (this));
  </script>
</body>
</html>
